@page "/apidocs"
@using System.Text.Json

<PageTitle>Documentación API - Climaguate</PageTitle>
<head>
  <title>Documentación API - Climaguate</title>
  <meta name="description" content="Documentación de los endpoints REST de Climaguate. Ejemplos de solicitudes, respuestas y parámetros para clima, calidad del aire y cultivos." />
</head>

<h1 style="color:#2B4C6F; font-size:1.8rem;">Documentación API</h1>
<hr style="border-color:#7BCDC8; border-width:2px;" />

<div style="font-size:0.85rem; line-height:1.6;">
    <p>
        Esta página describe los endpoints REST disponibles en Climaguate.<br/>
        Todos los endpoints son públicos y devuelven datos en formato JSON.
    </p>

    <h2 style="color:#2B4C6F; font-size:1.1rem;">URL Base</h2>
    <pre style="background:#f8f9fa; border-radius:6px; padding:8px;">https://climaguate.com/data-api/rest/</pre>

    <h2 style="color:#2B4C6F; font-size:1.1rem;">Endpoints</h2>

    <!-- GetCities -->
    <div class="card mb-4" style="font-size:0.85rem;">
          <div class="card-header" style="background:#2B4C6F; color:#fff;"> <span class="badge bg-primary">GET</span> <span style="margin-left:8px;">/GetCities</span></div>
        <div class="card-body">
            <p>Devuelve la lista de ciudades disponibles en la base de datos.</p>
            <strong>Ejemplo de solicitud:</strong>
            <pre style="background:#f8f9fa; border-radius:6px; padding:8px;">GET /data-api/rest/GetCities</pre>
            <strong>Respuesta:</strong>
            <pre style="background:#f8f9fa; border-radius:6px; padding:8px;">{
  "value": [
    {
      "CityCode": "GUA",
      "CityName": "Ciudad de Guatemala",
      "ElevationMeters": 1500,
      "SoilType": "Andosol",
      "ClimateZone": "Cwb"
    },
    // ...más ciudades
  ]
}</pre>
        </div>
    </div>

    <!-- GetWeatherCity -->
    <div class="card mb-4" style="font-size:0.85rem;">
          <div class="card-header" style="background:#1976d2; color:#fff;"> <span class="badge bg-primary">GET</span> <span style="margin-left:8px;">/GetWeatherCity?CityCode=GUA</span></div>
        <div class="card-body">
            <p>Devuelve datos meteorológicos actuales e históricos para una ciudad.</p>
            <strong>Parámetros:</strong>
            <ul>
                <li><code>CityCode</code> (string, requerido) - Código de ciudad (ejemplo: "GUA")</li>
            </ul>
            <strong>Ejemplo de solicitud:</strong>
            <pre style="background:#f8f9fa; border-radius:6px; padding:8px;">GET /data-api/rest/GetWeatherCity?CityCode=GUA</pre>
            <strong>Respuesta:</strong>
            <pre style="background:#f8f9fa; border-radius:6px; padding:8px;">{
  "value": [
    {
      "Name": "Ciudad de Guatemala",
      "Main_Temp": 22.5,
      "Main_Humidity": 70,
      "Weather_Description": "Nublado",
      // ...más campos
    },
    // ...más lecturas
  ]
}</pre>
        </div>
    </div>

    <!-- GetWeatherForecast -->
    <div class="card mb-4" style="font-size:0.85rem;">
          <div class="card-header" style="background:#1976d2; color:#fff;"> <span class="badge bg-primary">GET</span> <span style="margin-left:8px;">/GetWeatherForecast?CityCode=GUA</span></div>
        <div class="card-body">
            <p>Devuelve el pronóstico meteorológico para una ciudad.</p>
            <strong>Parámetros:</strong>
            <ul>
                <li><code>CityCode</code> (string, requerido)</li>
            </ul>
            <strong>Ejemplo de solicitud:</strong>
            <pre style="background:#f8f9fa; border-radius:6px; padding:8px;">GET /data-api/rest/GetWeatherForecast?CityCode=GUA</pre>
            <strong>Respuesta:</strong>
            <pre style="background:#f8f9fa; border-radius:6px; padding:8px;">{
  "value": [
    {
      "Name": "Ciudad de Guatemala",
      "Forecast_Temp": 23.0,
      "Forecast_Humidity": 65,
      // ...más campos
    },
    // ...más pronósticos
  ]
}</pre>
        </div>
    </div>

    <!-- GetLatestAirQuality -->
    <div class="card mb-4" style="font-size:0.85rem;">
          <div class="card-header" style="background:#ffe58f; color:#333;"> <span class="badge bg-warning text-dark">GET</span> <span style="margin-left:8px;">/GetLatestAirQuality?CityCode=GUA</span></div>
        <div class="card-body">
            <p>Devuelve los datos más recientes de calidad del aire para una ciudad.</p>
            <strong>Parámetros:</strong>
            <ul>
                <li><code>CityCode</code> (string, requerido)</li>
            </ul>
            <strong>Ejemplo de solicitud:</strong>
            <pre style="background:#f8f9fa; border-radius:6px; padding:8px;">GET /data-api/rest/GetLatestAirQuality?CityCode=GUA</pre>
            <strong>Respuesta:</strong>
            <pre style="background:#f8f9fa; border-radius:6px; padding:8px;">{
  "value": [
    {
      "CityCode": "GUA",
      "AQI": 2,
      "CategorySpanish": "Aceptable",
      // ...más campos
    }
  ]
}</pre>
        </div>
    </div>

    <!-- GetCropsByCity -->
    <div class="card mb-4" style="font-size:0.85rem;">
          <div class="card-header" style="background:#b7eb8f; color:#333;"> <span class="badge bg-success">GET</span> <span style="margin-left:8px;">/GetCropsByCity?CityCode=GUA</span></div>
        <div class="card-body">
            <p>Devuelve la aptitud y detalles de cultivos para una ciudad.</p>
            <strong>Parámetros:</strong>
            <ul>
                <li><code>CityCode</code> (string, requerido)</li>
            </ul>
            <strong>Ejemplo de solicitud:</strong>
            <pre style="background:#f8f9fa; border-radius:6px; padding:8px;">GET /data-api/rest/GetCropsByCity?CityCode=GUA</pre>
            <strong>Respuesta:</strong>
            <pre style="background:#f8f9fa; border-radius:6px; padding:8px;">{
  "value": [
    {
      "CropCode": "MAIZ",
      "CropNameSpanish": "Maíz",
      "CurrentSuitabilityScore": 85,
      // ...más campos
    },
    // ...más cultivos
  ]
}</pre>
        </div>
    </div>

    <!-- GetCrops -->
    <div class="card mb-4" style="font-size:0.85rem;">
          <div class="card-header" style="background:#b7eb8f; color:#333;"> <span class="badge bg-success">GET</span> <span style="margin-left:8px;">/GetCrops?CropCode=MAIZ</span></div>
        <div class="card-body">
            <p>Devuelve información detallada para un cultivo específico.</p>
            <strong>Parámetros:</strong>
            <ul>
                <li><code>CropCode</code> (string, requerido)</li>
            </ul>
            <strong>Ejemplo de solicitud:</strong>
            <pre style="background:#f8f9fa; border-radius:6px; padding:8px;">GET /data-api/rest/GetCrops?CropCode=MAIZ</pre>
            <strong>Respuesta:</strong>
            <pre style="background:#f8f9fa; border-radius:6px; padding:8px;">{
  "value": [
    {
      "CropCode": "MAIZ",
      "CropNameSpanish": "Maíz",
      "Description": "Cereal básico en Guatemala.",
      // ...más campos
    }
  ]
}</pre>
        </div>
    </div>

      <!-- GetCitiesByCrop -->
      <div class="card mb-4" style="font-size:0.85rem; border:1px solid #7BCDC8;">
          <div class="card-header" style="background:#2B4C6F; color:#fff;"> <span class="badge bg-primary">GET</span> <span style="margin-left:8px;">/GetCitiesByCrop?CropCodes=MAIZ,TOMATE</span></div>
          <div class="card-body">
              <p>Devuelve las ciudades donde se cultivan los cultivos especificados.</p>
              <span class="badge bg-warning text-dark">Parámetros</span>
              <ul>
                  <li><span class="badge bg-light text-dark">CropCodes</span> <span style="color:#888;">(string, requerido) - Lista separada por comas de códigos de cultivos</span></li>
              </ul>
              <span class="badge bg-info text-dark">Ejemplo de solicitud</span>
              <pre style="background:#f8f9fa; border-radius:6px; border:1px solid #7BCDC8; padding:8px;">GET /data-api/rest/GetCitiesByCrop?CropCodes=MAIZ,TOMATE</pre>
              <span class="badge bg-secondary">Respuesta</span>
              <pre style="background:#f8f9fa; border-radius:6px; border:1px solid #7BCDC8; padding:8px;">{
    "value": [
      {
        "CityCode": "GUA",
        "CityName": "Ciudad de Guatemala",
        "CropCode": "MAIZ",
        // ...más campos
      },
      // ...más resultados
    ]
  }</pre>
          </div>
      </div>

  <h2 style="color:#2B4C6F; font-size:1.1rem;">Autenticación</h2>
  <div class="alert alert-info" style="font-size:0.85rem;">
    Todos los endpoints son públicos (acceso anónimo). No se requiere autenticación.
  </div>

  <h2 style="color:#2B4C6F; font-size:1.1rem;">Notas</h2>
  <ul>
    <li>Las respuestas están en formato JSON.</li>
    <li>Los parámetros se envían como query string.</li>
    <li>Para más detalles, consulta la <a href="https://github.com/Azure/data-api-builder">documentación oficial de Azure Data API Builder</a>.</li>
  </ul>
</div>
